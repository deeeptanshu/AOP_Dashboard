<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pulse of Action (POA) Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --primary: #0f172a;
      --secondary: #1e3a5f;
      --accent: #f97316;
      --accent-light: #fb923c;
      --surface: #ffffff;
      --surface-dark: #f8fafc;
      --border: #e2e8f0;
      --text: #0f172a;
      --text-muted: #64748b;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Work Sans', -apple-system, sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      color: var(--text);
      line-height: 1.6;
      padding: 1.5rem;
      min-height: 100vh;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
    }

    /* Header - Compact */
    .header {
      background: var(--primary);
      color: white;
      padding: 1.25rem 1.75rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, var(--accent) 0%, transparent 70%);
      opacity: 0.1;
      border-radius: 50%;
      transform: translate(30%, -30%);
    }

    .header-content {
      position: relative;
      z-index: 1;
    }

    h1 {
      font-family: 'DM Serif Display', serif;
      font-size: 1.75rem;
      font-weight: 400;
      margin-bottom: 0.2rem;
      letter-spacing: -0.5px;
    }

    .subtitle {
      color: #94a3b8;
      font-size: 0.85rem;
      font-weight: 300;
    }

    .export-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Work Sans', sans-serif;
      font-weight: 600;
      font-size: 0.8rem;
      transition: all 0.2s;
      box-shadow: var(--shadow);
      z-index: 2;
      text-decoration: none;
      display: inline-block;
    }

    .export-btn:hover {
      background: var(--accent-light);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* KPI Strip - Super Compact */
    .kpi-strip {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.65rem;
      margin-bottom: 1rem;
    }

    .kpi-card {
      background: var(--surface);
      border-radius: 6px;
      padding: 0.65rem 0.75rem;
      box-shadow: var(--shadow);
      transition: all 0.2s;
      border-top: 3px solid var(--accent);
      text-align: center;
    }

    .kpi-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .kpi-label {
      font-size: 0.6rem;
      color: var(--text-muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-bottom: 0.4rem;
      line-height: 1;
      display: block;
    }

    .kpi-value {
      font-family: 'DM Serif Display', serif;
      font-size: 1.75rem;
      font-weight: 400;
      color: var(--primary);
      line-height: 1;
      display: block;
      margin-bottom: 0.3rem;
    }

    .kpi-subtext {
      font-size: 0.55rem;
      color: var(--text-muted);
      line-height: 1.1;
    }

    /* Main Grid */
    .main-grid {
      display: grid;
      grid-template-columns: 240px 1fr;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    /* Input Panel - Ultra Compact */
    .input-panel {
      background: var(--surface);
      border-radius: 8px;
      padding: 1.1rem;
      box-shadow: var(--shadow);
    }

    .section-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.1rem;
      margin-bottom: 0.9rem;
      color: var(--primary);
      border-bottom: 2px solid var(--accent);
      padding-bottom: 0.4rem;
    }

    .input-group {
      margin-bottom: 0.75rem;
    }

    .input-label {
      display: block;
      margin-bottom: 0.25rem;
      font-weight: 600;
      color: var(--text);
      font-size: 0.72rem;
    }

    input[type="number"] {
      width: 100%;
      padding: 0.45rem;
      border: 2px solid var(--border);
      border-radius: 5px;
      font-size: 0.8rem;
      font-family: 'Work Sans', sans-serif;
      transition: all 0.2s;
      background: var(--surface-dark);
    }

    input[type="number"]:focus {
      outline: none;
      border-color: var(--accent);
      background: var(--surface);
    }

    .calculate-btn {
      width: 100%;
      background: var(--secondary);
      color: white;
      border: none;
      padding: 0.65rem;
      border-radius: 5px;
      font-family: 'Work Sans', sans-serif;
      font-weight: 600;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 0.5rem;
    }

    .calculate-btn:hover {
      background: var(--primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    /* Content Area */
    .content-area {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    /* Capacity Section */
    .capacity-section {
      background: var(--surface);
      border-radius: 8px;
      padding: 1.1rem;
      box-shadow: var(--shadow);
    }

    /* Charts Grid */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .chart-card {
      background: var(--surface);
      border-radius: 8px;
      padding: 1.1rem;
      box-shadow: var(--shadow);
    }

    .chart-title {
      font-family: 'DM Serif Display', serif;
      font-size: 0.95rem;
      margin-bottom: 0.9rem;
      color: var(--primary);
    }

    .chart-container {
      position: relative;
      height: 250px;
    }

    /* Table */
    .table-section {
      background: var(--surface);
      border-radius: 8px;
      padding: 1.1rem;
      box-shadow: var(--shadow);
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      table-layout: fixed;
    }

    thead {
      background: var(--primary);
      color: white;
    }

    th {
      padding: 0.65rem 0.4rem;
      text-align: center;
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.65rem;
      letter-spacing: 0.3px;
      width: auto;
    }

    td {
      padding: 0.65rem 0.4rem;
      border-bottom: 1px solid var(--border);
      text-align: center;
    }

    td:first-child {
      text-align: left;
      padding-left: 0.65rem;
    }

    th:first-child {
      text-align: left;
      padding-left: 0.65rem;
    }

    tbody tr:hover {
      background: var(--surface-dark);
    }

    .number-cell {
      font-variant-numeric: tabular-nums;
      font-weight: 500;
    }

    .positive {
      color: var(--success);
    }

    .negative {
      color: var(--danger);
    }

    .warning {
      color: var(--warning);
    }

    /* CTA Banner */
    .cta-banner {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      border-radius: 10px;
      padding: 1.75rem 1.5rem;
      margin-top: 1.5rem;
      box-shadow: var(--shadow-lg);
      text-align: center;
      position: relative;
      overflow: hidden;
      animation: fadeInUp 0.8s ease-out 0.3s both;
    }

    .cta-banner::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, var(--accent) 0%, transparent 70%);
      opacity: 0.12;
      border-radius: 50%;
    }

    .cta-content {
      position: relative;
      z-index: 1;
      max-width: 600px;
      margin: 0 auto;
    }

    .cta-badge {
      display: inline-block;
      background: var(--accent);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 16px;
      font-size: 0.68rem;
      font-weight: 600;
      margin-bottom: 0.8rem;
      letter-spacing: 0.2px;
      text-transform: uppercase;
    }

    .cta-headline {
      font-family: 'DM Serif Display', serif;
      font-size: 1.6rem;
      font-weight: 400;
      color: white;
      margin-bottom: 0.6rem;
      line-height: 1.2;
      letter-spacing: -0.3px;
    }

    .cta-subtext {
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 1.25rem;
      line-height: 1.5;
      font-weight: 300;
    }

    .cta-button {
      display: inline-block;
      background: var(--accent);
      color: white;
      padding: 0.75rem 2rem;
      border-radius: 6px;
      font-family: 'Work Sans', sans-serif;
      font-weight: 700;
      font-size: 0.95rem;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px 0 rgba(249, 115, 22, 0.35);
      border: 2px solid var(--accent);
    }

    .cta-button:hover {
      background: var(--accent-light);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px 0 rgba(249, 115, 22, 0.45);
      border-color: var(--accent-light);
    }

    .cta-trust {
      margin-top: 1rem;
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.65);
      font-weight: 400;
      font-style: italic;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .main-grid {
        grid-template-columns: 1fr;
      }

      .kpi-strip {
        grid-template-columns: repeat(2, 1fr);
      }

      .charts-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }

      .kpi-strip {
        grid-template-columns: repeat(2, 1fr);
      }

      h1 {
        font-size: 1.5rem;
      }

      .header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }

      .export-btn {
        width: 100%;
      }

      .cta-banner {
        padding: 1.5rem 1.25rem;
        margin-top: 1.25rem;
      }

      .cta-headline {
        font-size: 1.35rem;
      }

      .cta-subtext {
        font-size: 0.88rem;
        margin-bottom: 1rem;
      }

      .cta-button {
        padding: 0.7rem 1.75rem;
        font-size: 0.9rem;
        width: 100%;
        max-width: 280px;
      }

      .cta-trust {
        font-size: 0.7rem;
      }
    }

    @media (max-width: 480px) {
      .kpi-strip {
        grid-template-columns: 1fr;
      }

      .cta-headline {
        font-size: 1.2rem;
      }

      .cta-subtext {
        font-size: 0.85rem;
      }

      .cta-badge {
        font-size: 0.65rem;
        padding: 0.25rem 0.7rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-content">
        <h1>Pulse of Action (POA) Dashboard</h1>
        <p class="subtitle">Executive Workforce Planning Dashboard</p>
      </div>
      <a href="https://docs.google.com/spreadsheets/d/1YicOK3KZ4wysN8SlWAqXiciYDrgIXzzIdeQXFlFwQjw/edit?gid=0#gid=0" target="_blank" class="export-btn">
        <span style="margin-right: 0.3rem;">ðŸ“Š</span> Open in Google Sheets
      </a>
    </div>

    <!-- KPI Strip -->
    <div class="kpi-strip">
      <div class="kpi-card" style="border-top-color: #10b981;">
        <span class="kpi-label">Total Hires</span>
        <span class="kpi-value" id="kpi-total-hires">42</span>
        <span class="kpi-subtext">Planning horizon</span>
      </div>

      <div class="kpi-card" style="border-top-color: #f59e0b;">
        <span class="kpi-label">Interviewer Shortfall</span>
        <span class="kpi-value" id="kpi-interviewer-shortfall">0</span>
        <span class="kpi-subtext">Avg monthly gap</span>
      </div>

      <div class="kpi-card" style="border-top-color: #6366f1;">
        <span class="kpi-label">Attrition</span>
        <span class="kpi-value" id="kpi-attrition">12</span>
        <span class="kpi-subtext">Departures</span>
      </div>

      <div class="kpi-card" style="border-top-color: #0ea5e9;">
        <span class="kpi-label">Ending HC</span>
        <span class="kpi-value" id="kpi-ending-hc">150</span>
        <span class="kpi-subtext">Year-end</span>
      </div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Input Panel -->
      <div class="input-panel">
        <h2 class="section-title">Inputs</h2>
        
        <div class="input-group">
          <label class="input-label">Starting Headcount</label>
          <input type="number" id="startingHC" value="120" min="1">
        </div>

        <div class="input-group">
          <label class="input-label">Target End-of-Year HC</label>
          <input type="number" id="targetHC" value="150" min="1">
        </div>

        <div class="input-group">
          <label class="input-label">Annual Attrition %</label>
          <input type="number" id="attrition" value="12" min="0" max="100" step="0.1">
        </div>

        <div class="input-group">
          <label class="input-label">Avg Time-to-Fill (Days)</label>
          <input type="number" id="timeToFill" value="35" min="1">
        </div>

        <div class="input-group">
          <label class="input-label">Screen â†’ Interview %</label>
          <input type="number" id="screenToInterview" value="60" min="0" max="100" step="0.1">
        </div>

        <div class="input-group">
          <label class="input-label">Interview â†’ Offer %</label>
          <input type="number" id="interviewToOffer" value="45" min="0" max="100" step="0.1">
        </div>

        <div class="input-group">
          <label class="input-label">Offer â†’ Hire %</label>
          <input type="number" id="offerToHire" value="80" min="0" max="100" step="0.1">
        </div>

        <div class="input-group">
          <label class="input-label">Interviewers Available</label>
          <input type="number" id="interviewersAvailable" value="8" min="1">
        </div>

        <div class="input-group">
          <label class="input-label">Interviewer Capacity/Month</label>
          <input type="number" id="interviewsPerMonth" value="6" min="1">
        </div>

        <button class="calculate-btn" onclick="calculate()">Calculate Plan</button>
      </div>

      <!-- Content Area -->
      <div class="content-area">
        <!-- Capacity Chart -->
        <div class="capacity-section">
          <h3 class="chart-title">Interviewer Capacity vs Demand</h3>
          <canvas id="capacityChart" style="max-height: 220px;"></canvas>
        </div>

        <!-- Charts Grid -->
        <div class="charts-grid">
          <div class="chart-card">
            <h3 class="chart-title">Headcount vs Target</h3>
            <div class="chart-container">
              <canvas id="headcountChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3 class="chart-title">Planned Hires vs Attrition</h3>
            <div class="chart-container">
              <canvas id="hiresChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3 class="chart-title">Gap to Target</h3>
            <div class="chart-container">
              <canvas id="gapChart"></canvas>
            </div>
          </div>

          <div class="chart-card">
            <h3 class="chart-title">Annual Hiring Funnel</h3>
            <div class="chart-container">
              <canvas id="funnelChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Monthly Plan Table -->
    <div class="table-section">
      <h2 class="section-title">Monthly Execution Plan</h2>
      <table id="monthlyTable">
        <thead>
          <tr>
            <th>Month</th>
            <th class="number-cell">Start HC</th>
            <th class="number-cell">Hires</th>
            <th class="number-cell">Attrition</th>
            <th class="number-cell">End HC</th>
            <th class="number-cell">Gap</th>
            <th class="number-cell">Apps</th>
            <th class="number-cell">Screens</th>
            <th class="number-cell">Interviews</th>
            <th class="number-cell">Offers</th>
            <th class="number-cell">Interviewer Needed</th>
            <th class="number-cell">Interviewer Available</th>
            <th class="number-cell">Interviewer Gap</th>
          </tr>
        </thead>
        <tbody id="tableBody">
        </tbody>
      </table>
    </div>

    <!-- CTA Banner -->
    <div class="cta-banner">
      <div class="cta-content">
        <div class="cta-badge">Save 20â€“40% of interview time</div>
        <h2 class="cta-headline">Facing An Interviewer Bandwidth Crunch?</h2>
        <p class="cta-subtext">Scale hiring without overloading your team by outsourcing interviews with Intervue.</p>
        <a href="https://www.intervue.io/business-book-a-demo" target="_blank" class="cta-button">
          Book a Demo
        </a>
        <p class="cta-trust">Trusted by fast-scaling engineering teams</p>
      </div>
    </div>
  </div>

  <script>
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    let monthlyData = [];
    let charts = {};

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      calculate();
    });

    function calculate() {
      // Get inputs
      const startingHC = parseFloat(document.getElementById('startingHC').value);
      const targetHC = parseFloat(document.getElementById('targetHC').value);
      const attrition = parseFloat(document.getElementById('attrition').value);
      const timeToFill = parseFloat(document.getElementById('timeToFill').value);
      const screenToInterview = parseFloat(document.getElementById('screenToInterview').value) / 100;
      const interviewToOffer = parseFloat(document.getElementById('interviewToOffer').value) / 100;
      const offerToHire = parseFloat(document.getElementById('offerToHire').value) / 100;
      const interviewersAvailable = parseFloat(document.getElementById('interviewersAvailable').value);
      const interviewsPerMonth = parseFloat(document.getElementById('interviewsPerMonth').value);

      // Calculate monthly plan
      monthlyData = [];
      let currentHC = startingHC;
      
      for (let i = 0; i < 12; i++) {
        const monthsRemaining = 12 - i;
        const attritionThisMonth = Math.round(currentHC * (attrition / 100) / 12);
        const plannedHires = Math.round(((targetHC - currentHC) / monthsRemaining) + attritionThisMonth);
        const endingHC = currentHC + plannedHires - attritionThisMonth;
        const gap = targetHC - endingHC;

        // Funnel calculations
        const offers = offerToHire > 0 ? Math.round(plannedHires / offerToHire) : 0;
        const interviews = interviewToOffer > 0 ? Math.round(offers / interviewToOffer) : 0;
        const screens = screenToInterview > 0 ? Math.round(interviews / screenToInterview) : 0;
        const applications = screenToInterview > 0 ? Math.round(screens / screenToInterview) : 0;

        // Interviewer capacity
        const interviewersNeeded = interviewsPerMonth > 0 ? (interviews / interviewsPerMonth).toFixed(1) : 0;
        const interviewerGap = (interviewersAvailable - interviewersNeeded).toFixed(1);

        monthlyData.push({
          month: months[i],
          startingHC: Math.round(currentHC),
          plannedHires,
          attrition: attritionThisMonth,
          endingHC,
          gap,
          timeToFill,
          applications,
          screens,
          interviews,
          offers,
          interviewersNeeded: parseFloat(interviewersNeeded),
          interviewersAvailable,
          interviewerGap: parseFloat(interviewerGap)
        });

        currentHC = endingHC;
      }

      updateKPIs();
      updateTable();
      updateCharts();
    }

    function updateKPIs() {
      const totalHires = monthlyData.reduce((sum, m) => sum + m.plannedHires, 0);
      const totalAttrition = monthlyData.reduce((sum, m) => sum + m.attrition, 0);
      const endingHC = monthlyData[11].endingHC;
      const targetHC = parseFloat(document.getElementById('targetHC').value);
      const gap = targetHC - endingHC;
      
      // Calculate average interviewer shortfall (only negative gaps)
      const shortfalls = monthlyData.map(m => Math.abs(Math.min(0, m.interviewerGap)));
      const avgShortfall = shortfalls.reduce((sum, val) => sum + val, 0) / 12;

      document.getElementById('kpi-total-hires').textContent = totalHires;
      document.getElementById('kpi-interviewer-shortfall').textContent = Math.round(avgShortfall);
      document.getElementById('kpi-attrition').textContent = totalAttrition;
      document.getElementById('kpi-ending-hc').textContent = endingHC;
    }

    function updateTable() {
      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = '';

      monthlyData.forEach(data => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><strong>${data.month}</strong></td>
          <td class="number-cell">${data.startingHC}</td>
          <td class="number-cell">${data.plannedHires}</td>
          <td class="number-cell">${data.attrition}</td>
          <td class="number-cell">${data.endingHC}</td>
          <td class="number-cell ${data.gap > 0 ? 'negative' : data.gap < 0 ? 'positive' : ''}">${data.gap}</td>
          <td class="number-cell">${data.applications}</td>
          <td class="number-cell">${data.screens}</td>
          <td class="number-cell">${data.interviews}</td>
          <td class="number-cell">${data.offers}</td>
          <td class="number-cell">${Math.round(data.interviewersNeeded)}</td>
          <td class="number-cell">${data.interviewersAvailable}</td>
          <td class="number-cell ${data.interviewerGap < 0 ? 'warning' : 'positive'}">${Math.round(data.interviewerGap) > 0 ? '+' : ''}${Math.round(data.interviewerGap)}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function updateCharts() {
      const targetHC = parseFloat(document.getElementById('targetHC').value);

      // Destroy existing charts
      Object.values(charts).forEach(chart => chart && chart.destroy());

      // Headcount Chart
      charts.headcount = new Chart(document.getElementById('headcountChart'), {
        type: 'line',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Actual HC',
              data: monthlyData.map(d => d.endingHC),
              borderColor: '#f97316',
              backgroundColor: 'rgba(249, 115, 22, 0.1)',
              borderWidth: 2.5,
              tension: 0.4,
              fill: true,
              pointRadius: 3,
              pointHoverRadius: 5
            },
            {
              label: 'Target',
              data: Array(12).fill(targetHC),
              borderColor: '#0f172a',
              borderWidth: 2,
              borderDash: [6, 3],
              pointRadius: 0,
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                usePointStyle: true,
                padding: 12,
                font: { family: 'Work Sans', size: 10 }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(15, 23, 42, 0.9)',
              padding: 10,
              titleFont: { family: 'Work Sans', size: 11 },
              bodyFont: { family: 'Work Sans', size: 10 }
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            },
            x: {
              grid: { display: false },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            }
          }
        }
      });

      // Hires vs Attrition
      charts.hires = new Chart(document.getElementById('hiresChart'), {
        type: 'bar',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Hires',
              data: monthlyData.map(d => d.plannedHires),
              backgroundColor: '#10b981',
              borderRadius: 4
            },
            {
              label: 'Attrition',
              data: monthlyData.map(d => d.attrition),
              backgroundColor: '#ef4444',
              borderRadius: 4
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                usePointStyle: true,
                padding: 12,
                font: { family: 'Work Sans', size: 10 }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(15, 23, 42, 0.9)',
              padding: 10,
              titleFont: { family: 'Work Sans', size: 11 },
              bodyFont: { family: 'Work Sans', size: 10 }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            },
            x: {
              grid: { display: false },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            }
          }
        }
      });

      // Gap Chart
      charts.gap = new Chart(document.getElementById('gapChart'), {
        type: 'line',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Gap',
              data: monthlyData.map(d => d.gap),
              borderColor: '#ef4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              borderWidth: 2.5,
              tension: 0.4,
              fill: true,
              pointRadius: 3,
              pointHoverRadius: 5
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(15, 23, 42, 0.9)',
              padding: 10,
              titleFont: { family: 'Work Sans', size: 11 },
              bodyFont: { family: 'Work Sans', size: 10 }
            }
          },
          scales: {
            y: {
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            },
            x: {
              grid: { display: false },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            }
          }
        }
      });

      // Funnel Chart
      const totalApplications = monthlyData.reduce((sum, d) => sum + d.applications, 0);
      const totalScreens = monthlyData.reduce((sum, d) => sum + d.screens, 0);
      const totalInterviews = monthlyData.reduce((sum, d) => sum + d.interviews, 0);
      const totalOffers = monthlyData.reduce((sum, d) => sum + d.offers, 0);

      charts.funnel = new Chart(document.getElementById('funnelChart'), {
        type: 'bar',
        data: {
          labels: ['Apps', 'Screens', 'Interviews', 'Offers'],
          datasets: [
            {
              data: [totalApplications, totalScreens, totalInterviews, totalOffers],
              backgroundColor: ['#3b82f6', '#8b5cf6', '#ec4899', '#f97316'],
              borderRadius: 6
            }
          ]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(15, 23, 42, 0.9)',
              padding: 10,
              titleFont: { family: 'Work Sans', size: 11 },
              bodyFont: { family: 'Work Sans', size: 10 }
            }
          },
          scales: {
            x: {
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            },
            y: {
              grid: { display: false },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            }
          }
        }
      });

      // Capacity Chart
      const interviewersAvailable = parseFloat(document.getElementById('interviewersAvailable').value);
      
      charts.capacity = new Chart(document.getElementById('capacityChart'), {
        type: 'line',
        data: {
          labels: months,
          datasets: [
            {
              label: 'Capacity',
              data: Array(12).fill(interviewersAvailable),
              borderColor: '#3b82f6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              borderWidth: 2.5,
              fill: true,
              pointRadius: 0
            },
            {
              label: 'Required',
              data: monthlyData.map(d => d.interviewersNeeded),
              borderColor: '#0f172a',
              backgroundColor: 'rgba(15, 23, 42, 0.1)',
              borderWidth: 2.5,
              fill: true,
              pointRadius: 3,
              pointHoverRadius: 5
            },
            {
              label: 'Shortfall',
              data: monthlyData.map(d => Math.abs(Math.min(0, d.interviewerGap))),
              borderColor: '#ef4444',
              backgroundColor: 'rgba(239, 68, 68, 0.2)',
              borderWidth: 2.5,
              fill: true,
              pointRadius: 3,
              pointHoverRadius: 5
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: {
                usePointStyle: true,
                padding: 12,
                font: { family: 'Work Sans', size: 10 }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(15, 23, 42, 0.9)',
              padding: 10,
              titleFont: { family: 'Work Sans', size: 11 },
              bodyFont: { family: 'Work Sans', size: 10 }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'FTE',
                font: { family: 'Work Sans', size: 11, weight: '600' }
              },
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            },
            x: {
              grid: { display: false },
              ticks: { font: { family: 'Work Sans', size: 10 } }
            }
          }
        }
      });
    }
  </script>
</body>
</html>
